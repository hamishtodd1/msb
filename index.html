<!--
	Sigh, bets from judgement turns into cash
	Increase aws capability
	Get camera access
	Test. Can get more playtesters from:
		StrangeCharms
		GMTK
		Senthuran, his wife, and Chao
	Bugs
		iphone camera is frozen
		You get black frickin squares. Refreshing makes it go away...
			Some worked, some black as well!
			PROBABLY only happens when a new player enters, you don't get sent them
		PROBABLY If your display goes to sleep, the socket goes
		Facebook web browser full screen
		This-is-not-an-advert in order to make sounds play
	World's shortest murder mystery
	Make a video where you play it
	
	
	Mute button? Eh, just turn off the sound Rowan
	Could have an automated thing: when you buy a bet, however much extra probability this puts into the suspect, that much is sold, equally, from the other suspects
	Possibly betting on "who should be put on the pitch" in a football simulator
	Lobbyist mode
		With lobbyist mode, you also have a lot of bets more expensive than what the person gets for them. Then, a strategy: if you know someone is trying to manipulate the price of X to be >80p at 1pm, but the true price of X is 20p, you can:
		-buy a load of bets on X at <80p
		-wait until 12:59pm when the price is 81p
		-sell a bet, price goes down to 79p
		-watch the manipulator buy so price goes back to 81p
		-sell again
		-manipulator buys again
		etc. Only problem is, you have to buy when 

		Yes, key thing is that there should be unlimited bets, so that the manipulator is forced to make the price extraordinarily high so that when everyone sells it's still above the watermark

		If you can figure out how much the manipulator gains from having the price be past the watermark, you can pump all that money out of them



		No reason why it should be secret really. Say how much cash the manipulator gets, and who they are, and what suspect they're going for.

		Easter egg: open console and set newGameButton.manipulatorMode = true before clicking it

		-how much money they get
		-how much extra money they start with
		-When the suspect appears, a 25-second timer starts. If the suspect's bets are trading at 1:1 when it's done, the manipulator gets N dollars.
	Another fun thing would be a bot mode where you see that wealth gets reallocated pretty quickly

	"World's shortest mrder mystery"
	Script for "murder mystery", sock puppets:
        Ahh help I'm being murdered
            BUT WHO COULD HAVE DONE THIS??
        Hello, I'm his estranged wife, and I must admit I really grew to dislike him
        I'm his Butler. I really liked him but it must be said that I had motive to 
        pause
        Didn't he say something about readjusting his will tomorrow?

        Hello. Well, I'm a Butler. But I certainly didn't do it
        AND I... AM... a random passer by, I don't know who that is at all
        Really? I could swear I've seen you around
        Nope, honestly never been here before. Are you sure you didn't do it?
        Well, ok, to be honest I did do it, I just couldn't stand him any more
        Alright I guess that clears that up
        OR DOES IT?
        No, yes, it's cleared up, it was definitely me
        THE END

        Oh alright, it was me actually

        Me: This man has been killed! But who was it?
        A: Well, I never liked him anyway
        B: I liked him a lot, although I do wish he would keep away from my poisonous frog collection
        Hmm, there is also his ex wife, who appears to have absconded to the bahamas
        Oh, it turns out it was me

	Manipulator  will get 1 googol dollars from the market price being above 1
	So they're willing to lose .9999 = 1 googol dollars
	To bet, if there are 10 bets

	The game should be about crafting trajectories for objects using whatever
	Then you can have nice shit in the levels on top of that, rendered with whatever hotness makes sense
	Maybe it should be completely about making loops, no beginning or end, no worry about controls / seeing the whole thing when it's embedded in an article



    Send to
        Testing Groups:
			EE slack: Pontus, Nicky, Chris Makler
			Martin Todd, Diana, Lal, mum and dad
			Chigozie, Devon, Florian and Jacob
			Eleanor, Stephane, Rachel, Rory and Joel
			Ivan, Ivan, Nina, Katya
			Edindies: Norgg, Portponkey
		Serious folks (need rooms by this point, they'll want to spread it)
			London rationalish: Jason Sackey, Noah Siegel, Phil Hazelden, Maciej
			->Then ask them about, facebook rationalists: Vladyslav, Jeffrey Ladish
			York philosophy: Simon Newey, Seb, Dan, Joe Peach
			Casey, Jon Blow "colleague of Caplan's".
			Ben Cerveney, Richard Lemarchand
			Chao, Senthuran
		Odds and ends
			Eric Stansifer
			Mike Munger
			Martin Berger
			Andrew Mathers
			Other people on those panels on youtube
			that chinese harvard lady
		Publicity
			Vitalik Buterin
			Lex Friedman
			wsb, hacker news
			r/wsb
			r/ssc
			r/prediction markets must exist
			lesswrong
			SSC open thread
			Annie Duke
			Andy should see it
			Zvi
			Noahpinion
			Julia Galef (so you think you're good at whodunnits...)	
			rob wiblin, katja grace, Carl Shulman whoever that is
 -->

<html>
	<html>
	<head><meta
		charset="utf-8"><meta
		name="viewport" content="width=device-width, initial-scale=1">

		<title>Murder, She Bet [BETA]</title>

		<link href="generalStyle.css" rel="stylesheet" type="text/css">
	</head>

	<body>

	<header>
	<h1><center>Murder, She Bet</center></h1>
	</header>

	<br></br>
	
	<center><button type="button" id="newGameButton">Start a new game!</button></center>
	
	<p>
		<center>Or enter GameId:</center>
		<center><textarea id="gameIdBox" name="gameIdBox" rows="1" cols="74">
		</textarea></center>
		<center><button type="button" id="enterGameButton">Submit</button></center>
	</p>
	
	<br></br>

	<center><h3><em>Murder, She Bet</em> is a game about putting your money where your <del>mouth</del> probabilistic beliefs are</h3></center>

	<br></br>

	<h3>The rules:</h3>
	<ol>
		<li>Players will watch a Murder Mystery, with multiple <em>suspects</em> that may be <em>guilty</em></li>
		<li>Suspect characters will be added to the board as they appear</li>
		<li>Bets may be bought and sold all the way up to when the credits roll</li>
		<li>Upon the rolling of the credits, the guilt or innocence of suspects will be settled</li>
		<li>Bets on guilty suspects turn into money, bets on innocent suspects are worthless</li>
	</ol>

	<br></br>

	<center><h3>This is what a game looks like:</h3></center>

	<center><iframe width="100%" height="56.25%" src="https://www.youtube.com/embed/dQw4w9WgXcQ" frameborder="0"
		allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
		allowfullscreen="false"></iframe></center>

	<br></br>

	<center><h3>For practice: The World's Shortest Murder Mystery!</h3></center>

	<center><iframe width="100%" height="56.25%" src="https://www.youtube.com/embed/dQw4w9WgXcQ" frameborder="0"
		allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
		allowfullscreen="false"></iframe></center>

	<br></br>

	<h3>A good strategy:</h3>
	<ol>
		<li>When you look at the board, ignore what's in your hand, just look at the current percentage</li>
		<li>For each, ask yourself "do I think it's more likely, or less likely, than that, they're guilty?"</li>
		<li>If you think it's more likely that they did it, eg they are at 20% and you think it's 50%, buy a bet</li>
		<li>If you think it's less likely than the board does, sell a bet, or if you have none to sell, do nothing</li>
		<li>Keep doing that! Though don't forget to look up and watch the show sometimes!</li>
	</ol>

	<br></br>

	<center>Created by <a href='https://twitter.com/hamish_todd'>@hamish_todd</a></center>
	<center>More information on the game and its philosophy can be found <a href= 'https://github.com/hamishtodd1/msb/blob/main/README.md'>here</a></center>

	<body>
		<script src="/socket.io/socket.io.js"></script>
		
		<script src="three.min.js"></script>
		<script src="instancedMesh.js"></script>

		<script src="variables.js"></script>
		<script src="miscFunctions.js"></script>

		<script src="mouse.js"></script>

		<script src="camera.js"></script>
		<script src="cashBits.js"></script>
		<script src="bets.js"></script>
		<script src="suspects.js"></script>
		<script src="board.js"></script>

		<script src="sound.js"></script>

		<script src="judgement.js"></script>

		<script>
			const module = { exports: {} }
		</script>
		<script src="shared.js"></script>

		<script src="rectangle.js"></script>

		<script src="windowResize.js"></script>

		<script src="text.js"></script>

		<script src="buttons.js"></script>

		<script src="socketStuffAndPageInitialization.js"></script>

		<script>
			async function init(socket, gameId) {
				initSound()

				// initInstancedMesh()
				initRectangles()

				renderer = new THREE.WebGLRenderer({ antialias: true });
				renderer.setClearColor(bgColor)

				initButtons()

				let updateMouse = initMouse()
				
				await initBoard()

				initWindowResize()

				let idBoxDimension = 1.
				const idBox = Rectangle({
					label: "Game ID: " + gameId,
					getScaleFromLabel: true,
					haveIntendedPosition: true,
					haveFrame: true
				})
				dashboard.push(idBox)

				initJudgement()

				{
					const connectionLostBox = Rectangle({
						label: "Connection lost",
						h: 2.,
						getScaleFromLabel: true,
						haveFrame: true,
						z: 4.9
					})

					let timeSinceLastPongReception = 0.
					socket.on("pongAA",()=>{
						timeSinceLastPongReception = 0.
					})
					updateFunctions.push(()=>{
						let aboutToPass2 = timeSinceLastPongReception < 2. &&
							timeSinceLastPongReception + frameDelta >= 2.
						if( aboutToPass2 )
							socket.emit("pingAA")

						connectionLostBox.visible = timeSinceLastPongReception > 4.
						if(timeSinceLastPongReception > 8.)
							location.reload()

						timeSinceLastPongReception += frameDelta
					})
				}

				socket.emit("ready for suspect portraits")

				function loop() {
					let clockDelta = clock.getDelta()
					frameDelta = clockDelta < .1 ? clockDelta : .1 //clamped because debugger pauses create weirdness

					mouse.updateFromAsync()

					updateFunctions.forEach((uf) => uf())

					++frameCount

					renderer.render(scene, camera)
					setTimeout(() => {
						requestAnimationFrame(loop)
					}, 1000. / 60.);
				}

				loop()
			}
		</script>
		
	</body>
</html>